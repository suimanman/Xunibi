{"ast":null,"code":"import axios from \"axios\";\nconst http = axios.create({\n  baseURL: \"http://localhost:8080\",\n  // 后端服务地址\n  timeout: 10000 // 请求超时时间\n});\nexport default {\n  data() {\n    return {\n      searchQuery: \"\",\n      // 搜索内容\n      noticeData: [],\n      // 公告数据\n      filteredNoticeData: [],\n      // 筛选后的公告数据\n      dialogVisible: false,\n      // 弹窗是否可见\n      dialogTitle: \"\",\n      // 弹窗标题\n      form: {\n        id: null,\n        content: \"\",\n        display: false // 默认显示\n      },\n      formRules: {\n        content: [{\n          required: true,\n          message: \"请输入公告内容\",\n          trigger: \"blur\"\n        }],\n        display: [{\n          required: true,\n          message: \"请选择是否显示\",\n          trigger: \"change\"\n        }]\n      }\n    };\n  },\n  methods: {\n    // 查询公告（在前端筛选）\n    search() {\n      if (!this.searchQuery) {\n        this.filteredNoticeData = this.noticeData;\n        this.$message.info(\"请输入查询条件！\");\n        return;\n      }\n      this.filteredNoticeData = this.noticeData.filter(item => item.id.toString().includes(this.searchQuery));\n      if (this.filteredNoticeData.length > 0) {\n        this.$message.success(\"筛选完成！\");\n      } else {\n        this.$message.warning(\"未找到匹配的公告！\");\n      }\n    },\n    // 重置查询条件\n    reset() {\n      this.searchQuery = \"\";\n      this.filteredNoticeData = this.noticeData; // 恢复为完整数据\n      this.$message.info(\"查询条件已重置！\");\n    },\n    // 打开新增/编辑弹窗\n    openDialog(type, row = {}) {\n      this.dialogTitle = type === \"add\" ? \"新增公告\" : \"编辑公告\";\n      this.dialogVisible = true;\n      if (type === \"add\") {\n        // 清空表单数据\n        this.form = {\n          id: null,\n          content: \"\",\n          display: null\n        };\n      } else {\n        this.form = {\n          ...row,\n          display: row.display === true || row.display === \"true\"\n        };\n      }\n    },\n    // 保存公告\n    save() {\n      this.$refs.formRef.validate(valid => {\n        if (!valid) return;\n        const apiCall = this.form.id ? http.put(`/notices/${this.form.id}`, this.form) // 编辑\n        : http.post(\"/notices\", this.form); // 新增\n\n        apiCall.then(() => {\n          this.$message.success(this.form.id ? \"编辑成功！\" : \"新增成功！\");\n          this.dialogVisible = false;\n          this.fetchData(); // 刷新数据\n        }).catch(error => {\n          console.error(\"Failed to save notice:\", error);\n          this.$message.error(this.form.id ? \"编辑失败！\" : \"新增失败！\");\n        });\n      });\n    },\n    // 删除公告\n    del(id) {\n      this.$confirm(\"确认删除此公告吗？\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        http.delete(`/notices/${id}`).then(() => {\n          this.$message.success(\"删除成功！\");\n          this.fetchData(); // 重新加载数据\n        }).catch(error => {\n          console.error(\"Failed to delete:\", error);\n          this.$message.error(\"删除失败！\");\n        });\n      }).catch(() => {\n        this.$message.info(\"已取消删除\");\n      });\n    },\n    // 格式化是否显示\n    formatDisplay(row) {\n      return row.display === true ? \"是\" : \"否\";\n    },\n    // 格式化日期\n    formatDate(row) {\n      const date = new Date(row.createdAt);\n      return date.toLocaleString(); // 本地化时间\n    },\n    // 获取公告数据\n    fetchData() {\n      http.get(\"/notices\").then(response => {\n        this.noticeData = response.data.data || [];\n        this.filteredNoticeData = this.noticeData; // 初始化时显示全部数据\n      }).catch(error => {\n        console.error(\"Failed to fetch data:\", error);\n        this.$message.error(\"加载公告失败！\");\n      });\n    }\n  },\n  mounted() {\n    // 初始化加载公告数据\n    this.fetchData();\n  }\n};","map":{"version":3,"names":["axios","http","create","baseURL","timeout","data","searchQuery","noticeData","filteredNoticeData","dialogVisible","dialogTitle","form","id","content","display","formRules","required","message","trigger","methods","search","$message","info","filter","item","toString","includes","length","success","warning","reset","openDialog","type","row","save","$refs","formRef","validate","valid","apiCall","put","post","then","fetchData","catch","error","console","del","$confirm","confirmButtonText","cancelButtonText","delete","formatDisplay","formatDate","date","Date","createdAt","toLocaleString","get","response","mounted"],"sources":["src/views/manage/NoticeView.vue"],"sourcesContent":["<template>\n    <div>\n        <!-- 搜索框 -->\n        <div class=\"search\">\n            <el-input v-model=\"searchQuery\" placeholder=\"请输入id查询\" style=\"width: 200px\" />\n            <el-button type=\"info\" plain style=\"margin-left: 10px\" @click=\"search\" icon=\"el-icon-zoom-in\">查询</el-button>\n            <el-button type=\"warning\" plain style=\"margin-left: 10px\" @click=\"reset\"\n                icon=\"el-icon-refresh-left\">重置</el-button>\n            <el-button type=\"primary\" plain @click=\"openDialog('add')\">新增</el-button>\n        </div>\n\n        <!-- 公告表格 -->\n        <div class=\"table\">\n            <el-table :data=\"filteredNoticeData\" border>\n                <el-table-column prop=\"id\" label=\"Id\" sortable width=\"150\" />\n                <el-table-column prop=\"content\" label=\"公告内容\" />\n                <el-table-column prop=\"createdAt\" label=\"公告发布时间\" :formatter=\"formatDate\" width=\"180\" />\n                <el-table-column prop=\"display\" label=\"是否显示\" :formatter=\"formatDisplay\" width=\"120\" />\n                <el-table-column label=\"操作\" width=\"200\">\n                    <template slot-scope=\"scope\">\n                        <el-button size=\"mini\" type=\"primary\" plain @click=\"openDialog('edit', scope.row)\">\n                            编辑\n                        </el-button>\n                        <el-button size=\"mini\" type=\"danger\" plain @click=\"del(scope.row.id)\">\n                            删除\n                        </el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n        </div>\n\n        <!-- 新增/编辑弹窗 -->\n        <el-dialog :title=\"dialogTitle\" :visible=\"dialogVisible\" width=\"500px\">\n            <el-form :model=\"form\" :rules=\"formRules\" ref=\"formRef\" label-width=\"100px\">\n                <el-form-item label=\"公告内容\" prop=\"content\">\n                    <el-input v-model=\"form.content\" placeholder=\"请输入公告内容\" />\n                </el-form-item>\n                <el-form-item label=\"是否显示\" prop=\"display\">\n                    <el-switch v-model=\"form.display\" :active-text=\"'显示'\" :inactive-text=\"'隐藏'\" />\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogVisible = false\">取消</el-button>\n                <el-button type=\"primary\" @click=\"save\">保存</el-button>\n            </div>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nconst http = axios.create({\n    baseURL: \"http://localhost:8080\", // 后端服务地址\n    timeout: 10000, // 请求超时时间\n});\n\nexport default {\n    data() {\n        return {\n            searchQuery: \"\", // 搜索内容\n            noticeData: [], // 公告数据\n            filteredNoticeData: [], // 筛选后的公告数据\n            dialogVisible: false, // 弹窗是否可见\n            dialogTitle: \"\", // 弹窗标题\n            form: {\n                id: null,\n                content: \"\",\n                display: false, // 默认显示\n            },\n            formRules: {\n                content: [{ required: true, message: \"请输入公告内容\", trigger: \"blur\" }],\n                display: [{ required: true, message: \"请选择是否显示\", trigger: \"change\" }],\n            },\n        };\n    },\n    methods: {\n        // 查询公告（在前端筛选）\n        search() {\n            if (!this.searchQuery) {\n                this.filteredNoticeData = this.noticeData;\n                this.$message.info(\"请输入查询条件！\");\n                return;\n            }\n            this.filteredNoticeData = this.noticeData.filter((item) =>\n                item.id.toString().includes(this.searchQuery)\n            );\n            if (this.filteredNoticeData.length > 0) {\n                this.$message.success(\"筛选完成！\");\n            } else {\n                this.$message.warning(\"未找到匹配的公告！\");\n            }\n        },\n        // 重置查询条件\n        reset() {\n            this.searchQuery = \"\";\n            this.filteredNoticeData = this.noticeData; // 恢复为完整数据\n            this.$message.info(\"查询条件已重置！\");\n        },\n        // 打开新增/编辑弹窗\n        openDialog(type, row = {}) {\n            this.dialogTitle = type === \"add\" ? \"新增公告\" : \"编辑公告\";\n            this.dialogVisible = true;\n            if (type === \"add\") {\n                // 清空表单数据\n                this.form = { id: null, content: \"\", display: null };\n            } else {\n                this.form = {\n                    ...row,\n                    display: row.display === true || row.display === \"true\",\n                };\n            }\n        },\n        // 保存公告\n        save() {\n            this.$refs.formRef.validate((valid) => {\n                if (!valid) return;\n\n                const apiCall = this.form.id\n                    ? http.put(`/notices/${this.form.id}`, this.form) // 编辑\n                    : http.post(\"/notices\", this.form); // 新增\n\n                apiCall\n                    .then(() => {\n                        this.$message.success(this.form.id ? \"编辑成功！\" : \"新增成功！\");\n                        this.dialogVisible = false;\n                        this.fetchData(); // 刷新数据\n                    })\n                    .catch((error) => {\n                        console.error(\"Failed to save notice:\", error);\n                        this.$message.error(this.form.id ? \"编辑失败！\" : \"新增失败！\");\n                    });\n            });\n        },\n        // 删除公告\n        del(id) {\n            this.$confirm(\"确认删除此公告吗？\", \"提示\", {\n                confirmButtonText: \"确定\",\n                cancelButtonText: \"取消\",\n                type: \"warning\",\n            })\n                .then(() => {\n                    http.delete(`/notices/${id}`)\n                        .then(() => {\n                            this.$message.success(\"删除成功！\");\n                            this.fetchData(); // 重新加载数据\n                        })\n                        .catch((error) => {\n                            console.error(\"Failed to delete:\", error);\n                            this.$message.error(\"删除失败！\");\n                        });\n                })\n                .catch(() => {\n                    this.$message.info(\"已取消删除\");\n                });\n        },\n        // 格式化是否显示\n        formatDisplay(row) {\n            return row.display === true ? \"是\" : \"否\";\n        },\n        // 格式化日期\n        formatDate(row) {\n            const date = new Date(row.createdAt);\n            return date.toLocaleString(); // 本地化时间\n        },\n        // 获取公告数据\n        fetchData() {\n            http.get(\"/notices\")\n                .then((response) => {\n                    this.noticeData = response.data.data || [];\n                    this.filteredNoticeData = this.noticeData; // 初始化时显示全部数据\n                })\n                .catch((error) => {\n                    console.error(\"Failed to fetch data:\", error);\n                    this.$message.error(\"加载公告失败！\");\n                });\n        },\n    },\n    mounted() {\n        // 初始化加载公告数据\n        this.fetchData();\n    },\n};\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}