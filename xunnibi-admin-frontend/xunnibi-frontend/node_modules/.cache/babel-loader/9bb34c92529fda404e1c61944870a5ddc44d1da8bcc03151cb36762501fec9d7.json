{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  data() {\n    return {\n      searchQuery: \"\",\n      teams: [],\n      // 所有团队数据\n      currentPage: 1,\n      // 当前页\n      pageSize: 10,\n      // 每页显示数量\n      paginatedTeams: [],\n      // 当前页显示的数据\n      dialogVisible: false,\n      newTeam: {\n        teamId: null,\n        teamName: \"\",\n        virtualCoins: 0,\n        creationDate: null\n      },\n      editMode: false\n    };\n  },\n  created() {\n    this.load(); // 页面加载时获取数据\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    // 加载数据\n    async load() {\n      try {\n        const response = await axios.get(\"http://localhost:8080/team/list\");\n        if (response.status === 200 && response.data) {\n          this.teams = response.data; // 更新所有团队数据\n          this.handlePageChange(this.currentPage); // 确保分页正确显示\n        }\n      } catch (error) {\n        console.error(\"数据加载失败:\", error);\n      }\n    },\n    handlePageSizeChange(newSize) {\n      this.pageSize = newSize;\n      this.currentPage = 1; // 重置到第一页\n      this.updateDisplayedData();\n    },\n    updateDisplayedData() {\n      const start = (this.currentPage - 1) * this.pageSize;\n      const end = start + this.pageSize;\n      // 确保分页的队列正确显示数据\n      this.paginatedTeams = this.teams.slice(start, end);\n    },\n    // 分页处理\n    handlePageChange(page) {\n      this.currentPage = page;\n      this.updateDisplayedData();\n\n      // 打印分页数据，调试时使用\n      console.log(\"currentPage:\", this.currentPage);\n      console.log(\"start:\", start, \"end:\", end);\n      console.log(\"paginatedTeams:\", this.paginatedTeams);\n    },\n    // 添加团队\n    handleAdd() {\n      this.newTeam = {\n        teamId: null,\n        teamName: \"\",\n        virtualCoins: 0,\n        creationDate: null\n      };\n      this.editMode = false;\n      this.dialogVisible = true;\n    },\n    // 删除团队\n    async del(teamId) {\n      try {\n        await axios.delete(`http://localhost:8080/team/delete/${teamId}`);\n        this.$message.success(\"删除成功\");\n        this.load();\n      } catch (error) {\n        console.error(\"删除失败:\", error);\n        this.$message.error(\"删除失败\");\n      }\n    },\n    // 编辑团队\n    handleEdit(row) {\n      this.newTeam = {\n        ...row\n      };\n      this.editMode = true;\n      this.dialogVisible = true;\n    },\n    // 保存团队\n    async saveTeam() {\n      try {\n        if (this.editMode) {\n          await axios.put(`http://localhost:8080/team/update/${this.newTeam.teamId}`, this.newTeam);\n          this.$message.success(\"更新成功\");\n        } else {\n          await axios.post(\"http://localhost:8080/team/create\", this.newTeam);\n          this.$message.success(\"新增成功\");\n        }\n        this.dialogVisible = false;\n        this.load();\n      } catch (error) {\n        console.error(\"保存失败:\", error);\n        this.$message.error(\"保存失败\");\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","searchQuery","teams","currentPage","pageSize","paginatedTeams","dialogVisible","newTeam","teamId","teamName","virtualCoins","creationDate","editMode","created","load","mounted","methods","response","get","status","handlePageChange","error","console","handlePageSizeChange","newSize","updateDisplayedData","start","end","slice","page","log","handleAdd","del","delete","$message","success","handleEdit","row","saveTeam","put","post"],"sources":["src/views/manage/TeamView.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"search\">\n      <el-input v-model=\"searchQuery\" placeholder=\"请输入团队ID查询\" style=\"width: 200px\"></el-input>\n      <el-button type=\"info\" plain style=\"margin-left: 10px\" @click=\"search\" icon=\"el-icon-zoom-in\">查询</el-button>\n      <el-button type=\"warning\" plain style=\"margin-left: 10px\" @click=\"reset\" icon=\"el-icon-refresh-left\">重置</el-button>\n      <el-button type=\"primary\" plain @click=\"handleAdd\">新增</el-button>\n    </div>\n    <div class=\"table\">\n      <el-table :data=\"paginatedTeams\" @selection-change=\"handleSelectionChange\" border>\n        <el-table-column prop=\"teamId\" label=\"团队ID\" sortable></el-table-column>\n        <el-table-column prop=\"teamName\" label=\"团队名称\"></el-table-column>\n        <el-table-column prop=\"virtualCoins\" label=\"虚拟币数量\"></el-table-column>\n        <el-table-column prop=\"creationDate\" label=\"入住日期\"></el-table-column>\n        <el-table-column label=\"操作\">\n          <template v-slot=\"scope\">\n            <el-button size=\"mini\" type=\"primary\" plain @click=\"handleEdit(scope.row)\">编辑</el-button>\n            <el-button size=\"mini\" type=\"danger\" plain @click=\"del(scope.row.teamId)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n    <el-pagination\n        v-if=\"teams.length > 0\"\n        background\n        layout=\"prev, pager, next,sizes, total, jumper\"\n        :page-size=\"pageSize\"\n        :current-page.sync=\"currentPage\"\n        :total=\"teams.length\"\n        @current-change=\"handlePageChange\"\n        @size-change=\"handlePageSizeChange\"\n    >\n    </el-pagination>\n\n    <el-dialog :title=\"editMode ? '编辑团队' : '新增团队'\" :visible.sync=\"dialogVisible\">\n      <el-form :model=\"newTeam\">\n        <el-form-item label=\"团队名称\">\n          <el-input v-model=\"newTeam.teamName\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"虚拟币数量\">\n          <el-input v-model=\"newTeam.virtualCoins\" type=\"number\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"入住日期\">\n          <el-date-picker v-model=\"newTeam.creationDate\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"saveTeam\">保存</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      searchQuery: \"\",\n      teams: [], // 所有团队数据\n      currentPage: 1, // 当前页\n      pageSize: 10, // 每页显示数量\n      paginatedTeams: [], // 当前页显示的数据\n      dialogVisible: false,\n      newTeam: {\n        teamId: null,\n        teamName: \"\",\n        virtualCoins: 0,\n        creationDate: null,\n      },\n      editMode: false,\n    };\n  },\n  created() {\n    this.load(); // 页面加载时获取数据\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    // 加载数据\n    async load() {\n      try {\n        const response = await axios.get(\"http://localhost:8080/team/list\");\n        if (response.status === 200 && response.data) {\n          this.teams = response.data; // 更新所有团队数据\n          this.handlePageChange(this.currentPage); // 确保分页正确显示\n        }\n      } catch (error) {\n        console.error(\"数据加载失败:\", error);\n      }\n    },\n    handlePageSizeChange(newSize){\n      this.pageSize = newSize;\n      this.currentPage = 1; // 重置到第一页\n      this.updateDisplayedData();\n\n    },\n    updateDisplayedData(){\n      const start = (this.currentPage - 1) * this.pageSize;\n      const end =  start + this.pageSize\n      // 确保分页的队列正确显示数据\n      this.paginatedTeams = this.teams.slice(start, end);\n    },\n    // 分页处理\n    handlePageChange(page) {\n      this.currentPage = page;\n      this.updateDisplayedData()\n\n      // 打印分页数据，调试时使用\n      console.log(\"currentPage:\", this.currentPage);\n      console.log(\"start:\", start, \"end:\", end);\n      console.log(\"paginatedTeams:\", this.paginatedTeams);\n    },\n    // 添加团队\n    handleAdd() {\n      this.newTeam = { teamId: null, teamName: \"\", virtualCoins: 0, creationDate: null };\n      this.editMode = false;\n      this.dialogVisible = true;\n    },\n    // 删除团队\n    async del(teamId) {\n      try {\n        await axios.delete(`http://localhost:8080/team/delete/${teamId}`);\n        this.$message.success(\"删除成功\");\n        this.load();\n      } catch (error) {\n        console.error(\"删除失败:\", error);\n        this.$message.error(\"删除失败\");\n      }\n    },\n    // 编辑团队\n    handleEdit(row) {\n      this.newTeam = { ...row };\n      this.editMode = true;\n      this.dialogVisible = true;\n    },\n    // 保存团队\n    async saveTeam() {\n      try {\n        if (this.editMode) {\n          await axios.put(`http://localhost:8080/team/update/${this.newTeam.teamId}`, this.newTeam);\n          this.$message.success(\"更新成功\");\n        } else {\n          await axios.post(\"http://localhost:8080/team/create\", this.newTeam);\n          this.$message.success(\"新增成功\");\n        }\n        this.dialogVisible = false;\n        this.load();\n      } catch (error) {\n        console.error(\"保存失败:\", error);\n        this.$message.error(\"保存失败\");\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.container {\n  padding: 20px;\n  background-color: #f9f9f9;\n}\n\n.table {\n  margin-bottom: 20px;\n}\n</style>"],"mappings":"AAuDA,OAAAA,KAAA;AAEA;EACAC,KAAA;IACA;MACAC,WAAA;MACAC,KAAA;MAAA;MACAC,WAAA;MAAA;MACAC,QAAA;MAAA;MACAC,cAAA;MAAA;MACAC,aAAA;MACAC,OAAA;QACAC,MAAA;QACAC,QAAA;QACAC,YAAA;QACAC,YAAA;MACA;MACAC,QAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,QAAA;IACA,KAAAD,IAAA;EACA;EACAE,OAAA;IACA;IACA,MAAAF,KAAA;MACA;QACA,MAAAG,QAAA,SAAAlB,KAAA,CAAAmB,GAAA;QACA,IAAAD,QAAA,CAAAE,MAAA,YAAAF,QAAA,CAAAjB,IAAA;UACA,KAAAE,KAAA,GAAAe,QAAA,CAAAjB,IAAA;UACA,KAAAoB,gBAAA,MAAAjB,WAAA;QACA;MACA,SAAAkB,KAAA;QACAC,OAAA,CAAAD,KAAA,YAAAA,KAAA;MACA;IACA;IACAE,qBAAAC,OAAA;MACA,KAAApB,QAAA,GAAAoB,OAAA;MACA,KAAArB,WAAA;MACA,KAAAsB,mBAAA;IAEA;IACAA,oBAAA;MACA,MAAAC,KAAA,SAAAvB,WAAA,aAAAC,QAAA;MACA,MAAAuB,GAAA,GAAAD,KAAA,QAAAtB,QAAA;MACA;MACA,KAAAC,cAAA,QAAAH,KAAA,CAAA0B,KAAA,CAAAF,KAAA,EAAAC,GAAA;IACA;IACA;IACAP,iBAAAS,IAAA;MACA,KAAA1B,WAAA,GAAA0B,IAAA;MACA,KAAAJ,mBAAA;;MAEA;MACAH,OAAA,CAAAQ,GAAA,sBAAA3B,WAAA;MACAmB,OAAA,CAAAQ,GAAA,WAAAJ,KAAA,UAAAC,GAAA;MACAL,OAAA,CAAAQ,GAAA,yBAAAzB,cAAA;IACA;IACA;IACA0B,UAAA;MACA,KAAAxB,OAAA;QAAAC,MAAA;QAAAC,QAAA;QAAAC,YAAA;QAAAC,YAAA;MAAA;MACA,KAAAC,QAAA;MACA,KAAAN,aAAA;IACA;IACA;IACA,MAAA0B,IAAAxB,MAAA;MACA;QACA,MAAAT,KAAA,CAAAkC,MAAA,sCAAAzB,MAAA;QACA,KAAA0B,QAAA,CAAAC,OAAA;QACA,KAAArB,IAAA;MACA,SAAAO,KAAA;QACAC,OAAA,CAAAD,KAAA,UAAAA,KAAA;QACA,KAAAa,QAAA,CAAAb,KAAA;MACA;IACA;IACA;IACAe,WAAAC,GAAA;MACA,KAAA9B,OAAA;QAAA,GAAA8B;MAAA;MACA,KAAAzB,QAAA;MACA,KAAAN,aAAA;IACA;IACA;IACA,MAAAgC,SAAA;MACA;QACA,SAAA1B,QAAA;UACA,MAAAb,KAAA,CAAAwC,GAAA,2CAAAhC,OAAA,CAAAC,MAAA,SAAAD,OAAA;UACA,KAAA2B,QAAA,CAAAC,OAAA;QACA;UACA,MAAApC,KAAA,CAAAyC,IAAA,2CAAAjC,OAAA;UACA,KAAA2B,QAAA,CAAAC,OAAA;QACA;QACA,KAAA7B,aAAA;QACA,KAAAQ,IAAA;MACA,SAAAO,KAAA;QACAC,OAAA,CAAAD,KAAA,UAAAA,KAAA;QACA,KAAAa,QAAA,CAAAb,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}