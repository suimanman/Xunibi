{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as echarts from \"echarts\";\nexport default {\n  props: {\n    chartData: {\n      type: Array,\n      required: true\n    }\n  },\n  data() {\n    return {\n      ExpandChart: null\n    };\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.initChart(); // 等待 DOM 渲染完成后初始化图表\n    });\n    window.addEventListener(\"resize\", this.resizeChart); // 窗口大小变化时调整图表尺寸\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"resize\", this.resizeChart); // 防止内存泄漏\n  },\n  watch: {\n    chartData: {\n      immediate: true,\n      handler(newValue) {\n        this.updateChart(newValue);\n      }\n    }\n  },\n  methods: {\n    resizeChart() {\n      if (this.ExpandChart) {\n        this.ExpandChart.resize(); // 调整图表尺寸\n      }\n    },\n    initChart() {\n      // 确保 this.chartData 是有效的并且有数据\n      if (!this.chartData || this.chartData.length < 2) {\n        console.error(\"chartData 数据无效\");\n        return;\n      }\n      const chartDom = this.$refs.ExpandChart;\n      this.ExpandChart = echarts.init(chartDom);\n\n      // 构造 series 数据\n      const series = this.chartData.slice(1).map(row => ({\n        name: row[0],\n        // 系列名称，使用每行的第一个元素作为名称\n        type: \"line\",\n        data: row.slice(1),\n        // 数据，使用每行的剩余元素作为数据\n        smooth: true,\n        seriesLayoutBy: \"row\",\n        emphasis: {\n          focus: \"series\"\n        }\n      }));\n\n      // 添加 pie chart 配置\n      const pieSeries = {\n        type: \"pie\",\n        radius: \"30%\",\n        center: [\"50%\", \"25%\"],\n        // 调整饼图的位置\n        emphasis: {\n          focus: \"self\"\n        },\n        label: {\n          formatter: \"{b}: {@currentMonth} ({d}%)\"\n        },\n        encode: {\n          itemName: \"product\",\n          value: \"currentMonth\",\n          tooltip: \"currentMonth\"\n        },\n        z: 10 // 提高饼图的层级，避免被折线图遮挡\n      };\n      series.push(pieSeries); // 将饼图加入系列数据中\n\n      const option = {\n        legend: {},\n        tooltip: {\n          trigger: \"axis\",\n          showContent: false\n        },\n        dataset: {\n          source: this.chartData\n        },\n        xAxis: {\n          type: \"category\",\n          data: this.chartData[0].slice(1) // 使用第一行的数据作为x轴\n        },\n        yAxis: {\n          type: 'value' // 设置y轴类型为值轴，避免出现找不到yAxis的错误\n        },\n        grid: {\n          top: \"55%\" // 适当的调整 grid 的位置\n        },\n        series: series // 传入处理后的 series 数据\n      };\n      this.ExpandChart.setOption(option);\n    },\n    updateChart(newValue) {\n      // 确保新的 chartData 有效\n      if (!newValue || newValue.length < 2) {\n        console.error(\"更新的数据无效\");\n        return;\n      }\n      if (this.ExpandChart) {\n        const series = newValue.slice(1).map(row => ({\n          name: row[0],\n          // 系列名称，使用每行的第一个元素作为名称\n          type: \"line\",\n          data: row.slice(1),\n          // 数据，使用每行的剩余元素作为数据\n          smooth: true,\n          seriesLayoutBy: \"row\",\n          emphasis: {\n            focus: \"series\"\n          }\n        }));\n\n        // 更新饼图\n        const pieSeries = {\n          type: \"pie\",\n          radius: \"30%\",\n          center: [\"50%\", \"25%\"],\n          // 调整饼图的位置\n          emphasis: {\n            focus: \"self\"\n          },\n          label: {\n            formatter: \"{b}: {@currentMonth} ({d}%)\"\n          },\n          encode: {\n            itemName: \"product\",\n            value: \"currentMonth\",\n            tooltip: \"currentMonth\"\n          },\n          z: 10 // 提高饼图的层级，避免被折线图遮挡\n        };\n        series.push(pieSeries); // 将饼图加入系列数据中\n\n        this.ExpandChart.setOption({\n          dataset: {\n            source: newValue\n          },\n          xAxis: {\n            data: newValue[0].slice(1) // 更新x轴数据\n          },\n          yAxis: {\n            type: 'value' // 保证y轴类型是value\n          },\n          series: series // 更新的 series 数据\n        });\n      }\n    }\n  }\n};","map":{"version":3,"names":["echarts","props","chartData","type","Array","required","data","ExpandChart","mounted","$nextTick","initChart","window","addEventListener","resizeChart","beforeDestroy","removeEventListener","watch","immediate","handler","newValue","updateChart","methods","resize","length","console","error","chartDom","$refs","init","series","slice","map","row","name","smooth","seriesLayoutBy","emphasis","focus","pieSeries","radius","center","label","formatter","encode","itemName","value","tooltip","z","push","option","legend","trigger","showContent","dataset","source","xAxis","yAxis","grid","top","setOption"],"sources":["src/components/ExpandComponent.vue"],"sourcesContent":["<template>\n    <div ref=\"ExpandChart\" style=\"width: 100%; height: 600px;\"></div>\n</template>\n\n<script>\nimport * as echarts from \"echarts\";\n\nexport default {\n    props: {\n        chartData: {\n            type: Array,\n            required: true,\n        },\n    },\n    data() {\n        return {\n            ExpandChart: null,\n        };\n    },\n    mounted() {\n        this.$nextTick(() => {\n            this.initChart(); // 等待 DOM 渲染完成后初始化图表\n        });\n        window.addEventListener(\"resize\", this.resizeChart); // 窗口大小变化时调整图表尺寸\n    },\n    beforeDestroy() {\n        window.removeEventListener(\"resize\", this.resizeChart); // 防止内存泄漏\n    },\n    watch: {\n        chartData: {\n            immediate: true,\n            handler(newValue) {\n                this.updateChart(newValue);\n            },\n        },\n    },\n    methods: {\n        resizeChart() {\n            if (this.ExpandChart) {\n                this.ExpandChart.resize(); // 调整图表尺寸\n            }\n        },\n        initChart() {\n            // 确保 this.chartData 是有效的并且有数据\n            if (!this.chartData || this.chartData.length < 2) {\n                console.error(\"chartData 数据无效\");\n                return;\n            }\n\n            const chartDom = this.$refs.ExpandChart;\n            this.ExpandChart = echarts.init(chartDom);\n\n            // 构造 series 数据\n            const series = this.chartData.slice(1).map((row) => ({\n                name: row[0],  // 系列名称，使用每行的第一个元素作为名称\n                type: \"line\",\n                data: row.slice(1),  // 数据，使用每行的剩余元素作为数据\n                smooth: true,\n                seriesLayoutBy: \"row\",\n                emphasis: { focus: \"series\" },\n            }));\n\n            // 添加 pie chart 配置\n            const pieSeries = {\n                type: \"pie\",\n                radius: \"30%\",\n                center: [\"50%\", \"25%\"], // 调整饼图的位置\n                emphasis: { focus: \"self\" },\n                label: { formatter: \"{b}: {@currentMonth} ({d}%)\" },\n                encode: { itemName: \"product\", value: \"currentMonth\", tooltip: \"currentMonth\" },\n                z: 10,  // 提高饼图的层级，避免被折线图遮挡\n            };\n\n            series.push(pieSeries); // 将饼图加入系列数据中\n\n            const option = {\n                legend: {},\n                tooltip: {\n                    trigger: \"axis\",\n                    showContent: false,\n                },\n                dataset: {\n                    source: this.chartData,\n                },\n                xAxis: {\n                    type: \"category\",\n                    data: this.chartData[0].slice(1), // 使用第一行的数据作为x轴\n                },\n                yAxis: {\n                    type: 'value', // 设置y轴类型为值轴，避免出现找不到yAxis的错误\n                },\n                grid: {\n                    top: \"55%\",  // 适当的调整 grid 的位置\n                },\n                series: series,  // 传入处理后的 series 数据\n            };\n\n            this.ExpandChart.setOption(option);\n        },\n        updateChart(newValue) {\n            // 确保新的 chartData 有效\n            if (!newValue || newValue.length < 2) {\n                console.error(\"更新的数据无效\");\n                return;\n            }\n\n            if (this.ExpandChart) {\n                const series = newValue.slice(1).map((row) => ({\n                    name: row[0],  // 系列名称，使用每行的第一个元素作为名称\n                    type: \"line\",\n                    data: row.slice(1),  // 数据，使用每行的剩余元素作为数据\n                    smooth: true,\n                    seriesLayoutBy: \"row\",\n                    emphasis: { focus: \"series\" },\n                }));\n\n                // 更新饼图\n                const pieSeries = {\n                    type: \"pie\",\n                    radius: \"30%\",\n                    center: [\"50%\", \"25%\"], // 调整饼图的位置\n                    emphasis: { focus: \"self\" },\n                    label: { formatter: \"{b}: {@currentMonth} ({d}%)\" },\n                    encode: { itemName: \"product\", value: \"currentMonth\", tooltip: \"currentMonth\" },\n                    z: 10,  // 提高饼图的层级，避免被折线图遮挡\n                };\n\n                series.push(pieSeries); // 将饼图加入系列数据中\n\n                this.ExpandChart.setOption({\n                    dataset: {\n                        source: newValue,\n                    },\n                    xAxis: {\n                        data: newValue[0].slice(1), // 更新x轴数据\n                    },\n                    yAxis: {\n                        type: 'value', // 保证y轴类型是value\n                    },\n                    series: series,  // 更新的 series 数据\n                });\n            }\n        },\n    },\n};\n</script>\n\n<style scoped>\n/* 样式可以根据需要进行自定义 */\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}